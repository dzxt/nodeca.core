//- need cut base of ns menu path ('admin.menus.navbar')
- var MENU_BASE_NS_LEVEL = 3
//- need cut base of api path ('admin')
- var API_PATH_BASE_NS_LEVEL = 1
- var api_path_tail = self.head.apiPath.split('.').slice(API_PATH_BASE_NS_LEVEL).join('.')
- var last_element


//- fetch next breadcrumb level
//-
//-   menu (Array)   - menu
//-   result (Array) - breadcrumbs container
mixin _fetch_breadcrumbs(menu, result)
  - var item_path_tail
  - each item in menu
    - item_path_tail= item.title.split('.').slice(MENU_BASE_NS_LEVEL).join('.')

    - if (api_path_tail.indexOf(item_path_tail) > -1)
      // If ACP item without link, then take link from first chaild
      - if (!item.to)
        item_link = item.childs[0].to
      - else
        item_link = item.to

      - result.push({ 
      -   text: self.t(item.title),
      -   route: item_link,
      -   tail: item_path_tail
      - })

      - if (item.childs)
        mixin _fetch_breadcrumbs(item.childs, result)


- if (self.menus.admin && self.menus.admin.navbar && !self.widgets.breadcrumbs)
  - self.widgets.breadcrumbs = []
  mixin _fetch_breadcrumbs(self.menus.admin.navbar, self.widgets.breadcrumbs)
  - if (self.widgets.breadcrumbs.length)
    //- if current api path != last breadcrumb element
    //- then add page title
    - if ( self.widgets.breadcrumbs.slice(-1)[0].tail !== api_path_tail)
      - self.widgets.breadcrumbs.push({ text: self.head.title });

- if (self.widgets.breadcrumbs && self.widgets.breadcrumbs.length)
  - last_element = self.widgets.breadcrumbs.pop()
  ul.breadcrumb
    - each item in self.widgets.breadcrumbs
      li
        - if (item.route)
          a(href=self.link_to(item.route))= item.text
        - else
          | #{item.text}
        span.divider: /
    li.active
      | #{last_element.text}
